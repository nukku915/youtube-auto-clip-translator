# GUIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°è¨ˆç”»æ›¸

## 1. æ¦‚è¦

### ç›®çš„
CustomTkinterã‚’ä½¿ç”¨ã—ã¦ã€ç›´æ„Ÿçš„ã§ä½¿ã„ã‚„ã™ã„ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æä¾›ã™ã‚‹

### è²¬å‹™
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æä¾›
- ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ç·¨é›†æ©Ÿèƒ½
- é€²æ—è¡¨ç¤ºãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†
- è¨­å®šç®¡ç†

---

## 2. ç”»é¢æ§‹æˆ

### 2.1 ç”»é¢ä¸€è¦§

| ç”»é¢ | èª¬æ˜ |
|------|------|
| HomeView | ãƒ›ãƒ¼ãƒ ç”»é¢ï¼ˆURLå…¥åŠ›ï¼‰ |
| ProcessingView | å‡¦ç†ä¸­ç”»é¢ï¼ˆé€²æ—è¡¨ç¤ºï¼‰ |
| EditorView | ç·¨é›†ç”»é¢ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰ |
| PreviewView | ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ |
| ExportView | å‡ºåŠ›è¨­å®šç”»é¢ |
| SettingsView | è¨­å®šç”»é¢ |

### 2.2 ç”»é¢é·ç§»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HomeView   â”‚  URLå…¥åŠ›
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ å‡¦ç†é–‹å§‹
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ProcessingViewâ”‚  ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ â†’ æ–‡å­—èµ·ã“ã— â†’ AIåˆ†æ
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ å®Œäº†
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EditorView  â”‚  åˆ‡ã‚ŠæŠœãç·¨é›†ãƒ»å­—å¹•ç·¨é›†ãƒ»ãƒãƒ£ãƒ—ã‚¿ãƒ¼ç·¨é›†
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PreviewView  â”‚  å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ æˆ»ã‚‹
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EditorView  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ æ›¸ãå‡ºã—
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ExportView  â”‚  å‡ºåŠ›è¨­å®šãƒ»æ›¸ãå‡ºã—å®Ÿè¡Œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. å„ç”»é¢ã®è©³ç´°è¨­è¨ˆ

### 3.1 HomeViewï¼ˆãƒ›ãƒ¼ãƒ ç”»é¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  YouTube Auto Clip Translator                          [âš™]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                      ğŸ¬                                     â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ YouTube URL ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„                       â”‚   â”‚
â”‚   â”‚ https://www.youtube.com/watch?v=...                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚                    [  å‡¦ç†ã‚’é–‹å§‹  ]                         â”‚
â”‚                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                             â”‚
â”‚   æœ€è¿‘ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ğŸ“ å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«1         2024/01/15  [é–‹ã]         â”‚   â”‚
â”‚   â”‚ ğŸ“ å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«2         2024/01/14  [é–‹ã]         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | ç¨®é¡ | æ©Ÿèƒ½ |
|---------------|------|------|
| url_entry | CTkEntry | URLå…¥åŠ› |
| start_button | CTkButton | å‡¦ç†é–‹å§‹ |
| recent_list | CTkScrollableFrame | æœ€è¿‘ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ |
| settings_button | CTkButton | è¨­å®šç”»é¢ã¸ |

---

### 3.2 ProcessingViewï¼ˆå‡¦ç†ä¸­ç”»é¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‡¦ç†ä¸­...                                            [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«: Amazing Video Title                         â”‚
â”‚   URL: https://www.youtube.com/watch?v=XXXXX               â”‚
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  45%        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   ç¾åœ¨ã®å‡¦ç†: æ–‡å­—èµ·ã“ã—ä¸­...                               â”‚
â”‚                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                             â”‚
â”‚   âœ“ å‹•ç”»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Œäº†         00:32                      â”‚
â”‚   âœ“ éŸ³å£°æŠ½å‡ºå®Œäº†                 00:05                      â”‚
â”‚   â—‹ æ–‡å­—èµ·ã“ã—ä¸­...              01:23                      â”‚
â”‚   â—‹ AIåˆ†æ                       å¾…æ©Ÿä¸­                     â”‚
â”‚                                                             â”‚
â”‚                     [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å‡¦ç†ã‚¹ãƒ†ãƒƒãƒ—
1. å‹•ç”»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
2. éŸ³å£°æŠ½å‡º
3. æ–‡å­—èµ·ã“ã—
4. AIåˆ†æï¼ˆè¦‹ã©ã“ã‚ãƒ»ãƒãƒ£ãƒ—ã‚¿ãƒ¼ãƒ»ã‚¿ã‚¤ãƒˆãƒ«ï¼‰

---

### 3.3 EditorViewï¼ˆç·¨é›†ç”»é¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼                                                    [ä¿å­˜] [âš™]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                       â”‚ â”‚  ã‚»ã‚°ãƒ¡ãƒ³ãƒˆä¸€è¦§              â”‚ â”‚
â”‚ â”‚                                       â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚           å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼               â”‚ â”‚  â”‚ â˜‘ Ch1: ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°     â”‚ â”‚ â”‚
â”‚ â”‚                                       â”‚ â”‚  â”‚   0:00 - 1:30  â­85     â”‚ â”‚ â”‚
â”‚ â”‚                                       â”‚ â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚ â”‚                                       â”‚ â”‚  â”‚ â˜‘ Ch2: ãƒ¡ã‚¤ãƒ³è§£èª¬       â”‚ â”‚ â”‚
â”‚ â”‚              â–¶ 00:00 / 10:00          â”‚ â”‚  â”‚   2:00 - 5:00  â­92     â”‚ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚                                           â”‚  â”‚ â˜ Ch3: è£œè¶³èª¬æ˜        â”‚ â”‚ â”‚
â”‚ ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³                               â”‚  â”‚   5:30 - 7:00  â­45     â”‚ â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â•­â”€â”€â•®   â•­â”€â”€â”€â”€â•®  â•­â”€â•®    â•­â”€â”€â”€â”€â”€â”€â•®   â•­â”€â•® â”‚ â”‚                               â”‚ â”‚
â”‚ â”‚ â”‚  â”‚   â”‚    â”‚  â”‚ â”‚    â”‚      â”‚   â”‚ â”‚ â”‚ â”‚  [+ ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè¿½åŠ ]           â”‚ â”‚
â”‚ â”‚ â•°â”€â”€â•¯   â•°â”€â”€â”€â”€â•¯  â•°â”€â•¯    â•°â”€â”€â”€â”€â”€â”€â•¯   â•°â”€â•¯ â”‚ â”‚                               â”‚ â”‚
â”‚ â”‚|Ch1|   | Ch2  |       | Ch3  |      â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚ â”‚ â–¼      â–¼       â–¼       â–¼            â”‚ â”‚                               â”‚ â”‚
â”‚ â”‚ 0:00  1:30   2:00    5:00   5:30    â”‚ â”‚  é¸æŠä¸­ã‚»ã‚°ãƒ¡ãƒ³ãƒˆç·¨é›†          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  ã‚¿ã‚¤ãƒˆãƒ«: [Ch1: ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°]â”‚ â”‚
â”‚                                           â”‚  é–‹å§‹: [0:00.00]  çµ‚äº†: [1:30]â”‚ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å­—å¹•ä¸€è¦§                                                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ # â”‚ æ™‚é–“        â”‚ åŸæ–‡                    â”‚ è¨³æ–‡                       â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ 1 â”‚ 0:01-0:04  â”‚ Hello everyone         â”‚ çš†ã•ã‚“ã“ã‚“ã«ã¡ã¯            â”‚ â”‚
â”‚ â”‚ 2 â”‚ 0:04-0:08  â”‚ Welcome to my channel  â”‚ ãƒãƒ£ãƒ³ãƒãƒ«ã¸ã‚ˆã†ã“ã         â”‚ â”‚
â”‚ â”‚ 3 â”‚ 0:08-0:12  â”‚ Today we will discuss  â”‚ ä»Šæ—¥ã¯...ã«ã¤ã„ã¦è©±ã—ã¾ã™    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           [ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼]  [æ›¸ãå‡ºã—]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°

##### å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢
- å‹•ç”»ã®åŸ‹ã‚è¾¼ã¿è¡¨ç¤º
- å†ç”Ÿ/ä¸€æ™‚åœæ­¢ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
- ã‚·ãƒ¼ã‚¯ãƒãƒ¼
- éŸ³é‡èª¿æ•´

##### ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚¨ãƒªã‚¢
- æ³¢å½¢è¡¨ç¤º
- ã‚»ã‚°ãƒ¡ãƒ³ãƒˆç¯„å›²è¡¨ç¤ºï¼ˆãƒ‰ãƒ©ãƒƒã‚°ã§èª¿æ•´å¯èƒ½ï¼‰
- ãƒãƒ£ãƒ—ã‚¿ãƒ¼ãƒãƒ¼ã‚«ãƒ¼
- ç¾åœ¨ä½ç½®ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
- ã‚ºãƒ¼ãƒ æ©Ÿèƒ½

##### ã‚»ã‚°ãƒ¡ãƒ³ãƒˆä¸€è¦§
- ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§é¸æŠ/éé¸æŠ
- è¦‹ã©ã“ã‚ã‚¹ã‚³ã‚¢è¡¨ç¤º
- ãƒ‰ãƒ©ãƒƒã‚°ã§é †åºå¤‰æ›´
- ç·¨é›†ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³

##### å­—å¹•ä¸€è¦§
- åŸæ–‡ãƒ»è¨³æ–‡ã®ä¸¦åˆ—è¡¨ç¤º
- ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†
- ã‚¿ã‚¤ãƒŸãƒ³ã‚°èª¿æ•´
- ä¸€æ‹¬ç·¨é›†æ©Ÿèƒ½

---

### 3.4 PreviewViewï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼                                          [Ã—]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚                  å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼                      â”‚   â”‚
â”‚   â”‚              ï¼ˆå­—å¹•ç„¼ãä»˜ã‘æ¸ˆã¿ï¼‰                    â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚                                                     â”‚   â”‚
â”‚   â”‚              â–¶ 00:00 / 03:30                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   å‡ºåŠ›å½¢å¼:  â—‹ é€šå¸¸å‹•ç”» (16:9)   â—‹ Shorts (9:16)           â”‚
â”‚                                                             â”‚
â”‚               [ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã«æˆ»ã‚‹]  [æ›¸ãå‡ºã—]                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.5 ExportViewï¼ˆå‡ºåŠ›è¨­å®šç”»é¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ›¸ãå‡ºã—è¨­å®š                                         [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   å‡ºåŠ›å½¢å¼                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â˜‘ é€šå¸¸å‹•ç”» (16:9)                                   â”‚   â”‚
â”‚   â”‚ â˜‘ YouTube Shorts (9:16)                             â”‚   â”‚
â”‚   â”‚ â˜ ä¸¡æ–¹ã‚’1ã¤ã®å‹•ç”»ã«çµåˆ                              â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   å“è³ªè¨­å®š                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ãƒ—ãƒªã‚»ãƒƒãƒˆ: [â–¼ Balanced (æ¨å¥¨)              ]       â”‚   â”‚
â”‚   â”‚ è§£åƒåº¦:     [â–¼ 1920x1080 (å…ƒå‹•ç”»ã¨åŒã˜)     ]       â”‚   â”‚
â”‚   â”‚ å­—å¹•:       â˜‘ å‹•ç”»ã«ç„¼ãä»˜ã‘                        â”‚   â”‚
â”‚   â”‚ ã‚¿ã‚¤ãƒˆãƒ«:   â˜‘ ã‚¿ã‚¤ãƒˆãƒ«ã‚«ãƒ¼ãƒ‰ã‚’æŒ¿å…¥                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   å‡ºåŠ›å…ˆ                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ /Users/xxx/Videos/output          [ãƒ•ã‚©ãƒ«ãƒ€ã‚’é¸æŠ]   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   ãƒ•ã‚¡ã‚¤ãƒ«å: video_title_{format}_{date}                   â”‚
â”‚                                                             â”‚
â”‚   æ¨å®šã‚µã‚¤ã‚º: ç´„ 150 MB (é€šå¸¸) + 50 MB (Shorts)             â”‚
â”‚   æ¨å®šæ™‚é–“:   ç´„ 2 åˆ†                                       â”‚
â”‚                                                             â”‚
â”‚                    [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]  [æ›¸ãå‡ºã—é–‹å§‹]              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.6 SettingsViewï¼ˆè¨­å®šç”»é¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¨­å®š                                                 [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   ä¸€èˆ¬è¨­å®š                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ãƒ†ãƒ¼ãƒ:        [â–¼ ãƒ€ãƒ¼ã‚¯              ]             â”‚   â”‚
â”‚   â”‚ è¨€èª:          [â–¼ æ—¥æœ¬èª              ]             â”‚   â”‚
â”‚   â”‚ ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: /Users/xxx/Documents   [å¤‰æ›´]     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   APIè¨­å®š                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Gemini API Key: [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢] [è¡¨ç¤º] [æ¤œè¨¼]â”‚   â”‚
â”‚   â”‚ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: âœ“ æœ‰åŠ¹                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   å‡¦ç†è¨­å®š                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ WhisperXãƒ¢ãƒ‡ãƒ«:  [â–¼ distil-large-v3    ]            â”‚   â”‚
â”‚   â”‚ ãƒ‡ãƒã‚¤ã‚¹:        [â–¼ è‡ªå‹•æ¤œå‡º (GPU)     ]            â”‚   â”‚
â”‚   â”‚ è©±è€…åˆ†é›¢:        â˜ æœ‰åŠ¹åŒ–                           â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚   å­—å¹•è¨­å®š                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ãƒ•ã‚©ãƒ³ãƒˆ:        [â–¼ Noto Sans JP       ]            â”‚   â”‚
â”‚   â”‚ ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º:  [48] px                            â”‚   â”‚
â”‚   â”‚ äºŒè¨€èªè¡¨ç¤º:      â˜‘ æœ‰åŠ¹                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚                              [ä¿å­˜]  [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### 4.1 å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```
src/gui/components/
â”œâ”€â”€ video_player.py       # å‹•ç”»ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼
â”œâ”€â”€ timeline.py           # ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
â”œâ”€â”€ waveform.py           # æ³¢å½¢è¡¨ç¤º
â”œâ”€â”€ segment_list.py       # ã‚»ã‚°ãƒ¡ãƒ³ãƒˆä¸€è¦§
â”œâ”€â”€ subtitle_table.py     # å­—å¹•ãƒ†ãƒ¼ãƒ–ãƒ«
â”œâ”€â”€ progress_bar.py       # é€²æ—ãƒãƒ¼
â””â”€â”€ toast.py              # é€šçŸ¥ãƒˆãƒ¼ã‚¹ãƒˆ
```

### 4.2 VideoPlayer ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆmpvåŸ‹ã‚è¾¼ã¿ï¼‰

**æ±ºå®šäº‹é …**: mpvã‚’ä½¿ç”¨ã—ãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°å†ç”Ÿãƒ»å­—å¹•è¡¨ç¤º

```python
import mpv

class VideoPlayer(CTkFrame):
    """
    å‹•ç”»ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆmpvåŸ‹ã‚è¾¼ã¿ï¼‰

    æ©Ÿèƒ½:
    - å‹•ç”»ã®å†ç”Ÿ/ä¸€æ™‚åœæ­¢ï¼ˆéŸ³å£°ä»˜ãï¼‰
    - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å­—å¹•è¡¨ç¤ºï¼ˆASSãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œï¼‰
    - ã‚·ãƒ¼ã‚¯
    - éŸ³é‡èª¿æ•´
    - ç¾åœ¨æ™‚é–“è¡¨ç¤º
    """

    def __init__(self, parent, **kwargs):
        super().__init__(parent, **kwargs)

        # mpvãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã‚’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«åŸ‹ã‚è¾¼ã¿
        self.player = mpv.MPV(
            wid=str(int(self.winfo_id())),  # CustomTkinterã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«åŸ‹ã‚è¾¼ã¿
            vo="gpu",                        # GPUãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            hwdec="auto",                    # ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ‡ã‚³ãƒ¼ãƒ‰
            keep_open=True,                  # çµ‚äº†æ™‚ã‚‚é–‹ã„ãŸã¾ã¾
        )

    def load(self, video_path: Path, subtitle_path: Path = None) -> None:
        """å‹•ç”»ã‚’ãƒ­ãƒ¼ãƒ‰"""
        self.player.play(str(video_path))
        if subtitle_path:
            self.player.sub_file = str(subtitle_path)

    def update_subtitle(self, subtitle_path: Path) -> None:
        """
        å­—å¹•ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ï¼ˆç·¨é›†æ™‚ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åæ˜ ï¼‰

        å­—å¹•ç·¨é›† â†’ ä¸€æ™‚ASSãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ â†’ ã“ã®é–¢æ•°ã§åæ˜ 
        """
        self.player.sub_file = str(subtitle_path)
        self.player.command("sub-reload")

    def play(self) -> None:
        """å†ç”Ÿ"""
        self.player.pause = False

    def pause(self) -> None:
        """ä¸€æ™‚åœæ­¢"""
        self.player.pause = True

    def seek(self, time: float) -> None:
        """æŒ‡å®šæ™‚é–“ã«ã‚·ãƒ¼ã‚¯"""
        self.player.seek(time, "absolute")

    def get_current_time(self) -> float:
        """ç¾åœ¨ã®å†ç”Ÿæ™‚é–“ã‚’å–å¾—"""
        return self.player.time_pos or 0.0

    def set_volume(self, volume: float) -> None:
        """éŸ³é‡è¨­å®šï¼ˆ0.0-1.0ï¼‰"""
        self.player.volume = volume * 100

    def on_time_update(self, callback: Callable[[float], None]) -> None:
        """æ™‚é–“æ›´æ–°ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ç™»éŒ²"""
        @self.player.property_observer("time-pos")
        def on_time_pos(_name, value):
            if value is not None:
                callback(value)

    def destroy(self) -> None:
        """ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"""
        self.player.terminate()
        super().destroy()
```

### å­—å¹•ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ãƒ•ãƒ­ãƒ¼

```
å­—å¹•ç·¨é›†ï¼ˆGUIã§å¤‰æ›´ï¼‰
    â†“
ä¸€æ™‚ASSãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆï¼ˆå³åº§ã«ï¼‰
    â†“
VideoPlayer.update_subtitle(temp_ass_path)
    â†“
mpvãŒå­—å¹•ã‚’å†èª­ã¿è¾¼ã¿
    â†“
ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«å³åº§ã«åæ˜ 
```

### 4.3 Timeline ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```python
class Timeline(CTkFrame):
    """
    ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

    æ©Ÿèƒ½:
    - æ³¢å½¢è¡¨ç¤º
    - ã‚»ã‚°ãƒ¡ãƒ³ãƒˆç¯„å›²è¡¨ç¤º/ç·¨é›†
    - ã‚ºãƒ¼ãƒ /ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    - ãƒãƒ¼ã‚«ãƒ¼è¡¨ç¤º
    """

    def __init__(self, parent, **kwargs):
        super().__init__(parent, **kwargs)

    def set_waveform(self, waveform_data: np.ndarray, sample_rate: int) -> None:
        """æ³¢å½¢ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š"""

    def set_segments(self, segments: List[EditSegment]) -> None:
        """ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’è¨­å®š"""

    def set_current_time(self, time: float) -> None:
        """ç¾åœ¨æ™‚é–“ã‚’è¨­å®š"""

    def zoom(self, level: float) -> None:
        """ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«è¨­å®š"""

    def on_segment_change(self, callback: Callable[[EditSegment], None]) -> None:
        """ã‚»ã‚°ãƒ¡ãƒ³ãƒˆå¤‰æ›´ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯"""

    def on_seek(self, callback: Callable[[float], None]) -> None:
        """ã‚·ãƒ¼ã‚¯ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯"""
```

### 4.4 SubtitleTable ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

```python
class SubtitleTable(CTkScrollableFrame):
    """
    å­—å¹•ãƒ†ãƒ¼ãƒ–ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

    æ©Ÿèƒ½:
    - å­—å¹•ä¸€è¦§è¡¨ç¤º
    - ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†
    - é¸æŠ/ãƒã‚¤ãƒ©ã‚¤ãƒˆ
    - ã‚½ãƒ¼ãƒˆ/ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    """

    def __init__(self, parent, **kwargs):
        super().__init__(parent, **kwargs)

    def set_subtitles(self, subtitles: List[SubtitleEntry]) -> None:
        """å­—å¹•ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š"""

    def get_subtitles(self) -> List[SubtitleEntry]:
        """ç·¨é›†æ¸ˆã¿å­—å¹•ã‚’å–å¾—"""

    def highlight_row(self, index: int) -> None:
        """è¡Œã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ"""

    def on_edit(self, callback: Callable[[int, SubtitleEntry], None]) -> None:
        """ç·¨é›†ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯"""

    def on_select(self, callback: Callable[[int], None]) -> None:
        """é¸æŠã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯"""
```

---

## 5. çŠ¶æ…‹ç®¡ç†

### 5.1 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹

```python
@dataclass
class AppState:
    # ç¾åœ¨ã®ãƒ“ãƒ¥ãƒ¼
    current_view: str = "home"

    # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
    project: Optional[Project] = None
    is_modified: bool = False

    # å‡¦ç†çŠ¶æ…‹
    is_processing: bool = False
    processing_step: str = ""
    processing_progress: float = 0.0

    # ç·¨é›†çŠ¶æ…‹
    selected_segment_id: Optional[int] = None
    selected_subtitle_id: Optional[int] = None
    current_time: float = 0.0

    # è¨­å®š
    settings: AppSettings = field(default_factory=AppSettings)
```

### 5.2 çŠ¶æ…‹ç®¡ç†ã‚¯ãƒ©ã‚¹

```python
class StateManager:
    """
    ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®ç®¡ç†

    - çŠ¶æ…‹ã®æ›´æ–°
    - å¤‰æ›´é€šçŸ¥ï¼ˆObserver ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
    - æ°¸ç¶šåŒ–
    """

    def __init__(self):
        self._state = AppState()
        self._observers: List[Callable] = []

    def get_state(self) -> AppState:
        """ç¾åœ¨ã®çŠ¶æ…‹ã‚’å–å¾—"""

    def update(self, **kwargs) -> None:
        """çŠ¶æ…‹ã‚’æ›´æ–°"""

    def subscribe(self, callback: Callable[[AppState], None]) -> None:
        """å¤‰æ›´é€šçŸ¥ã‚’è³¼èª­"""

    def unsubscribe(self, callback: Callable) -> None:
        """è³¼èª­è§£é™¤"""

    def save(self) -> None:
        """çŠ¶æ…‹ã‚’æ°¸ç¶šåŒ–"""

    def load(self) -> None:
        """çŠ¶æ…‹ã‚’å¾©å…ƒ"""
```

---

## 6. ãƒ†ãƒ¼ãƒãƒ»ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

### 6.1 ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ 

```python
THEMES = {
    "dark": {
        "bg_primary": "#1a1a2e",
        "bg_secondary": "#16213e",
        "bg_tertiary": "#0f3460",
        "text_primary": "#ffffff",
        "text_secondary": "#a0a0a0",
        "accent": "#e94560",
        "success": "#4ade80",
        "warning": "#fbbf24",
        "error": "#ef4444",
    },
    "light": {
        "bg_primary": "#ffffff",
        "bg_secondary": "#f3f4f6",
        "bg_tertiary": "#e5e7eb",
        "text_primary": "#1f2937",
        "text_secondary": "#6b7280",
        "accent": "#3b82f6",
        "success": "#22c55e",
        "warning": "#f59e0b",
        "error": "#ef4444",
    }
}
```

### 6.2 ãƒ•ã‚©ãƒ³ãƒˆè¨­å®š

```python
FONTS = {
    "heading": ("Noto Sans JP", 24, "bold"),
    "subheading": ("Noto Sans JP", 18, "bold"),
    "body": ("Noto Sans JP", 14, "normal"),
    "small": ("Noto Sans JP", 12, "normal"),
    "mono": ("Noto Sans Mono", 14, "normal"),
}
```

---

## 7. ä¾å­˜é–¢ä¿‚

### Python ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
```
customtkinter>=5.2.0
pillow>=10.0.0
python-mpv>=1.0.0     # å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆmpvåŸ‹ã‚è¾¼ã¿ï¼‰
numpy>=1.24.0
librosa>=0.10.0       # æ³¢å½¢è¡¨ç¤º
```

### å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ï¼ˆè‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯¾è±¡ï¼‰
```
mpv                   # å‹•ç”»ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼
```

---

## 7.5 è‡ªå‹•ä¿å­˜ã¨ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè‡ªå‹•ä¿å­˜

**æ±ºå®šäº‹é …**: 30ç§’ã”ã¨ã«è‡ªå‹•ä¿å­˜ + æ‰‹å‹•ä¿å­˜

```python
AUTO_SAVE_CONFIG = {
    "interval_seconds": 30,
    "save_path": "~/.youtube-auto-clip-translator/autosave/",
    "max_autosaves": 5,  # å¤ã„ã‚‚ã®ã¯å‰Šé™¤
}

class AutoSaveManager:
    def __init__(self, state_manager: StateManager):
        self.timer = None
        self.start_auto_save()

    def start_auto_save(self):
        """è‡ªå‹•ä¿å­˜ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹"""
        self.timer = threading.Timer(
            AUTO_SAVE_CONFIG["interval_seconds"],
            self._save_and_reschedule
        )
        self.timer.start()

    def _save_and_reschedule(self):
        self._save_draft()
        self.start_auto_save()  # æ¬¡ã®ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚»ãƒƒãƒˆ

    def _save_draft(self):
        """ãƒ‰ãƒ©ãƒ•ãƒˆä¿å­˜"""
        ...
```

### å‡¦ç†ä¸­ã®ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°

**æ±ºå®šäº‹é …**: å‡¦ç†ä¸­ã¯ã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã‚Œãªã„ã‚ˆã†ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º

```python
class App(CTk):
    def __init__(self):
        super().__init__()
        self.protocol("WM_DELETE_WINDOW", self._on_close)

    def _on_close(self):
        """é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚"""
        if self.state_manager.get_state().is_processing:
            # å‡¦ç†ä¸­ã®å ´åˆ
            result = self._show_close_dialog()
            if result == "cancel":
                return  # é–‰ã˜ãªã„
            elif result == "force_close":
                self._cancel_processing()
                self.destroy()
        else:
            # å‡¦ç†ä¸­ã§ãªã„å ´åˆ
            if self.state_manager.get_state().is_modified:
                result = self._show_save_dialog()
                if result == "save":
                    self._save_project()
                elif result == "cancel":
                    return
            self.destroy()

    def _show_close_dialog(self) -> str:
        """å‡¦ç†ä¸­ã®ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°"""
        dialog = CTkMessagebox(
            title="å‡¦ç†ä¸­ã§ã™",
            message="å‡¦ç†ä¸­ã§ã™ã€‚çµ‚äº†ã™ã‚‹ã¨é€²è¡Œä¸­ã®å‡¦ç†ã¯ç ´æ£„ã•ã‚Œã¾ã™ã€‚\nçµ‚äº†ã—ã¾ã™ã‹ï¼Ÿ",
            options=["ã‚­ãƒ£ãƒ³ã‚»ãƒ«", "çµ‚äº†"]
        )
        return dialog.get()
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‡¦ç†ä¸­ã§ã™                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ å‡¦ç†ä¸­ã§ã™ã€‚çµ‚äº†ã™ã‚‹ã¨é€²è¡Œä¸­ã®å‡¦ç†ã¯ç ´æ£„ã•ã‚Œã¾ã™ã€‚       â”‚
â”‚ çµ‚äº†ã—ã¾ã™ã‹ï¼Ÿ                                          â”‚
â”‚                                                         â”‚
â”‚                    [ã‚­ãƒ£ãƒ³ã‚»ãƒ«]  [çµ‚äº†]                  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
src/gui/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ app.py              # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ home.py         # HomeView
â”‚   â”œâ”€â”€ processing.py   # ProcessingView
â”‚   â”œâ”€â”€ editor.py       # EditorView
â”‚   â”œâ”€â”€ preview.py      # PreviewView
â”‚   â”œâ”€â”€ export.py       # ExportView
â”‚   â””â”€â”€ settings.py     # SettingsView
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ video_player.py
â”‚   â”œâ”€â”€ timeline.py
â”‚   â”œâ”€â”€ waveform.py
â”‚   â”œâ”€â”€ segment_list.py
â”‚   â”œâ”€â”€ subtitle_table.py
â”‚   â”œâ”€â”€ progress_bar.py
â”‚   â””â”€â”€ toast.py
â”œâ”€â”€ state/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ app_state.py
â”‚   â””â”€â”€ state_manager.py
â”œâ”€â”€ theme/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ colors.py
â”‚   â””â”€â”€ fonts.py
â””â”€â”€ utils/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ async_utils.py  # éåŒæœŸå‡¦ç†ãƒ˜ãƒ«ãƒ‘ãƒ¼
```

---

## 9. éåŒæœŸå‡¦ç†

### 9.1 ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†

```python
class AsyncWorker:
    """
    ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ

    GUIã‚’ãƒ–ãƒ­ãƒƒã‚¯ã›ãšã«é‡ã„å‡¦ç†ã‚’å®Ÿè¡Œ
    """

    def __init__(self, app: CTk):
        self.app = app
        self._executor = ThreadPoolExecutor(max_workers=4)

    def run(
        self,
        task: Callable,
        on_complete: Callable = None,
        on_error: Callable = None,
        on_progress: Callable = None
    ) -> None:
        """ã‚¿ã‚¹ã‚¯ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œ"""

    def cancel(self) -> None:
        """å®Ÿè¡Œä¸­ã®ã‚¿ã‚¹ã‚¯ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«"""
```

### 9.2 é€²æ—æ›´æ–°

```python
def update_progress_from_thread(
    app: CTk,
    progress_bar: CTkProgressBar,
    value: float
) -> None:
    """
    åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã‹ã‚‰GUIã‚’å®‰å…¨ã«æ›´æ–°
    """
    app.after(0, lambda: progress_bar.set(value))
```

---

## 10. ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ

| ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ | æ©Ÿèƒ½ |
|--------------|------|
| Space | å†ç”Ÿ/ä¸€æ™‚åœæ­¢ |
| â† / â†’ | 5ç§’æˆ»ã‚‹/é€²ã‚€ |
| Shift + â† / â†’ | 1ç§’æˆ»ã‚‹/é€²ã‚€ |
| Ctrl + S | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¿å­˜ |
| Ctrl + Z | å…ƒã«æˆ»ã™ |
| Ctrl + Shift + Z | ã‚„ã‚Šç›´ã— |
| Ctrl + E | æ›¸ãå‡ºã— |
| Delete | é¸æŠã‚»ã‚°ãƒ¡ãƒ³ãƒˆå‰Šé™¤ |
| Escape | é¸æŠè§£é™¤ |

---

## 11. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©

### App ã‚¯ãƒ©ã‚¹

```python
class App(CTk):
    def __init__(self):
        super().__init__()
        self.state_manager = StateManager()
        self.worker = AsyncWorker(self)

    def navigate_to(self, view_name: str) -> None:
        """ãƒ“ãƒ¥ãƒ¼ã‚’åˆ‡ã‚Šæ›¿ãˆ"""

    def show_toast(self, message: str, type: str = "info") -> None:
        """ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤º"""

    def show_dialog(
        self,
        title: str,
        message: str,
        buttons: List[str]
    ) -> str:
        """ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º"""

    def start_processing(self, url: str) -> None:
        """å‡¦ç†ã‚’é–‹å§‹"""

    def cancel_processing(self) -> None:
        """å‡¦ç†ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«"""
```

---

## 12. ãƒ†ã‚¹ãƒˆé …ç›®

### UIãƒ†ã‚¹ãƒˆ
- [ ] å„ç”»é¢ã®è¡¨ç¤º
- [ ] ç”»é¢é·ç§»
- [ ] ãƒœã‚¿ãƒ³æ“ä½œ
- [ ] ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

### çµ±åˆãƒ†ã‚¹ãƒˆ
- [ ] URLå…¥åŠ›ã‹ã‚‰å®Œäº†ã¾ã§ã®ä¸€é€£ã®ãƒ•ãƒ­ãƒ¼
- [ ] ç·¨é›†æ“ä½œ
- [ ] æ›¸ãå‡ºã—å‡¦ç†
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

## 13. è¿½åŠ ä»•æ§˜

### 13.1 ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºåˆ¶ç´„

```python
@dataclass
class WindowConstraints:
    """ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºåˆ¶ç´„"""
    min_width: int = 1024
    min_height: int = 768
    default_width: int = 1280
    default_height: int = 800
    max_width: int = None  # åˆ¶é™ãªã—
    max_height: int = None  # åˆ¶é™ãªã—

# ãƒ“ãƒ¥ãƒ¼åˆ¥ã®æ¨å¥¨ã‚µã‚¤ã‚º
VIEW_SIZES = {
    "home": {"width": 800, "height": 600},
    "processing": {"width": 600, "height": 400},
    "editor": {"width": 1400, "height": 900},  # å¤§ãã‚ã‚’æ¨å¥¨
    "preview": {"width": 1000, "height": 700},
    "export": {"width": 700, "height": 600},
    "settings": {"width": 600, "height": 700},
}

class App(CTk):
    def __init__(self):
        super().__init__()

        # æœ€å°ã‚µã‚¤ã‚ºè¨­å®š
        self.minsize(
            WindowConstraints.min_width,
            WindowConstraints.min_height
        )

        # åˆæœŸã‚µã‚¤ã‚ºè¨­å®š
        self.geometry(f"{WindowConstraints.default_width}x{WindowConstraints.default_height}")

        # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½ç½®ã‚’ç”»é¢ä¸­å¤®ã«
        self._center_window()

    def _center_window(self):
        """ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ç”»é¢ä¸­å¤®ã«é…ç½®"""
        self.update_idletasks()
        width = self.winfo_width()
        height = self.winfo_height()
        screen_width = self.winfo_screenwidth()
        screen_height = self.winfo_screenheight()
        x = (screen_width - width) // 2
        y = (screen_height - height) // 2
        self.geometry(f"{width}x{height}+{x}+{y}")

    def navigate_to(self, view_name: str) -> None:
        """ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆæ™‚ã«ã‚µã‚¤ã‚ºèª¿æ•´ã‚’ææ¡ˆ"""
        recommended = VIEW_SIZES.get(view_name)
        if recommended:
            current_w = self.winfo_width()
            current_h = self.winfo_height()
            # ç¾åœ¨ã‚µã‚¤ã‚ºãŒå°ã•ã™ãã‚‹å ´åˆã®ã¿èª¿æ•´
            if current_w < recommended["width"] or current_h < recommended["height"]:
                new_w = max(current_w, recommended["width"])
                new_h = max(current_h, recommended["height"])
                self.geometry(f"{new_w}x{new_h}")
```

### 13.2 é«˜DPI/Retinaå¯¾å¿œ

```python
import platform
import ctypes

class DPIManager:
    """é«˜DPIç’°å¢ƒã®æ¤œå‡ºã¨å¯¾å¿œ"""

    def __init__(self):
        self.scale_factor = self._detect_scale_factor()

    def _detect_scale_factor(self) -> float:
        """ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¹ã‚±ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã‚’æ¤œå‡º"""
        system = platform.system()

        if system == "Windows":
            return self._get_windows_scale()
        elif system == "Darwin":  # macOS
            return self._get_macos_scale()
        else:  # Linux
            return self._get_linux_scale()

    def _get_windows_scale(self) -> float:
        """Windows DPIã‚¹ã‚±ãƒ¼ãƒ«å–å¾—"""
        try:
            # DPI Awarenessè¨­å®š
            ctypes.windll.shcore.SetProcessDpiAwareness(2)
            # ç¾åœ¨ã®DPIå–å¾—
            dc = ctypes.windll.user32.GetDC(0)
            dpi = ctypes.windll.gdi32.GetDeviceCaps(dc, 88)  # LOGPIXELSX
            ctypes.windll.user32.ReleaseDC(0, dc)
            return dpi / 96.0
        except Exception:
            return 1.0

    def _get_macos_scale(self) -> float:
        """macOS Retinaæ¤œå‡º"""
        try:
            from AppKit import NSScreen
            main_screen = NSScreen.mainScreen()
            return main_screen.backingScaleFactor()
        except ImportError:
            # AppKitãŒåˆ©ç”¨ã§ããªã„å ´åˆ
            return 2.0 if self._is_retina_display() else 1.0

    def _is_retina_display(self) -> bool:
        """Retinaåˆ¤å®šï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰"""
        try:
            import subprocess
            result = subprocess.run(
                ["system_profiler", "SPDisplaysDataType"],
                capture_output=True, text=True
            )
            return "Retina" in result.stdout
        except Exception:
            return False

    def _get_linux_scale(self) -> float:
        """Linux ã‚¹ã‚±ãƒ¼ãƒ«å–å¾—"""
        import os
        # GDK_SCALEç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
        gdk_scale = os.environ.get("GDK_SCALE", "1")
        try:
            return float(gdk_scale)
        except ValueError:
            return 1.0

    def scale_font_size(self, base_size: int) -> int:
        """ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°"""
        # é«˜DPIç’°å¢ƒã§ã¯CustomTkinterãŒè‡ªå‹•èª¿æ•´ã™ã‚‹ãŸã‚
        # è¿½åŠ ã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã¯ä¸è¦ãªå ´åˆãŒå¤šã„
        return base_size

    def scale_padding(self, base_padding: int) -> int:
        """ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°"""
        return int(base_padding * self.scale_factor)


# CustomTkinterè¨­å®š
def configure_dpi_settings():
    """DPIè¨­å®šã‚’é©ç”¨"""
    dpi_manager = DPIManager()

    # CustomTkinterã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°è¨­å®š
    import customtkinter as ctk

    if dpi_manager.scale_factor >= 2.0:
        # Retina/4Kç’°å¢ƒ
        ctk.set_widget_scaling(1.0)  # ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚¹ã‚±ãƒ¼ãƒ«
        ctk.set_window_scaling(1.0)  # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¹ã‚±ãƒ¼ãƒ«
    else:
        # é€šå¸¸ç’°å¢ƒ
        ctk.set_widget_scaling(dpi_manager.scale_factor)
        ctk.set_window_scaling(dpi_manager.scale_factor)
```

### 13.3 è¤‡æ•°ãƒ¢ãƒ‹ã‚¿å¯¾å¿œ

```python
from dataclasses import dataclass
from typing import List, Optional
import tkinter as tk

@dataclass
class MonitorInfo:
    """ãƒ¢ãƒ‹ã‚¿æƒ…å ±"""
    index: int
    x: int
    y: int
    width: int
    height: int
    is_primary: bool
    name: str = ""

class MultiMonitorManager:
    """è¤‡æ•°ãƒ¢ãƒ‹ã‚¿å¯¾å¿œ"""

    def __init__(self, root: tk.Tk):
        self.root = root
        self.monitors = self._detect_monitors()

    def _detect_monitors(self) -> List[MonitorInfo]:
        """æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ãƒ¢ãƒ‹ã‚¿ã‚’æ¤œå‡º"""
        monitors = []

        try:
            # screeninfoãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
            from screeninfo import get_monitors
            for i, m in enumerate(get_monitors()):
                monitors.append(MonitorInfo(
                    index=i,
                    x=m.x,
                    y=m.y,
                    width=m.width,
                    height=m.height,
                    is_primary=m.is_primary,
                    name=m.name or f"Monitor {i}"
                ))
        except ImportError:
            # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¢ãƒ‹ã‚¿ã®ã¿
            monitors.append(MonitorInfo(
                index=0,
                x=0,
                y=0,
                width=self.root.winfo_screenwidth(),
                height=self.root.winfo_screenheight(),
                is_primary=True,
                name="Primary"
            ))

        return monitors

    def get_primary_monitor(self) -> Optional[MonitorInfo]:
        """ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¢ãƒ‹ã‚¿ã‚’å–å¾—"""
        for m in self.monitors:
            if m.is_primary:
                return m
        return self.monitors[0] if self.monitors else None

    def get_current_monitor(self) -> Optional[MonitorInfo]:
        """ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒã‚ã‚‹ãƒ¢ãƒ‹ã‚¿ã‚’å–å¾—"""
        x = self.root.winfo_x()
        y = self.root.winfo_y()

        for m in self.monitors:
            if (m.x <= x < m.x + m.width and
                m.y <= y < m.y + m.height):
                return m

        return self.get_primary_monitor()

    def center_on_monitor(self, monitor: MonitorInfo) -> None:
        """æŒ‡å®šãƒ¢ãƒ‹ã‚¿ã®ä¸­å¤®ã«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é…ç½®"""
        self.root.update_idletasks()
        w = self.root.winfo_width()
        h = self.root.winfo_height()

        x = monitor.x + (monitor.width - w) // 2
        y = monitor.y + (monitor.height - h) // 2

        self.root.geometry(f"{w}x{h}+{x}+{y}")

    def maximize_on_current_monitor(self) -> None:
        """ç¾åœ¨ã®ãƒ¢ãƒ‹ã‚¿ã§æœ€å¤§åŒ–"""
        monitor = self.get_current_monitor()
        if monitor:
            # ã‚¿ã‚¹ã‚¯ãƒãƒ¼åˆ†ã‚’è€ƒæ…®ã—ãŸèª¿æ•´
            taskbar_height = 40  # æ¦‚ç®—å€¤
            self.root.geometry(
                f"{monitor.width}x{monitor.height - taskbar_height}"
                f"+{monitor.x}+{monitor.y}"
            )

    def remember_window_position(self) -> dict:
        """ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½ç½®ã‚’è¨˜æ†¶"""
        return {
            "x": self.root.winfo_x(),
            "y": self.root.winfo_y(),
            "width": self.root.winfo_width(),
            "height": self.root.winfo_height(),
            "monitor_index": self.get_current_monitor().index
                if self.get_current_monitor() else 0
        }

    def restore_window_position(self, position: dict) -> None:
        """ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½ç½®ã‚’å¾©å…ƒ"""
        # ãƒ¢ãƒ‹ã‚¿ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
        target_monitor = None
        for m in self.monitors:
            if m.index == position.get("monitor_index", 0):
                target_monitor = m
                break

        if target_monitor:
            # ä¿å­˜ä½ç½®ãŒãƒ¢ãƒ‹ã‚¿ç¯„å›²å†…ã‹ç¢ºèª
            x = position.get("x", 0)
            y = position.get("y", 0)
            if (target_monitor.x <= x < target_monitor.x + target_monitor.width and
                target_monitor.y <= y < target_monitor.y + target_monitor.height):
                self.root.geometry(
                    f"{position['width']}x{position['height']}+{x}+{y}"
                )
                return

        # å¾©å…ƒã§ããªã„å ´åˆã¯ãƒ—ãƒ©ã‚¤ãƒãƒªãƒ¢ãƒ‹ã‚¿ã®ä¸­å¤®ã«
        primary = self.get_primary_monitor()
        if primary:
            self.center_on_monitor(primary)
```

### 13.4 Undo/Redoå®Ÿè£…è©³ç´°

```python
from abc import ABC, abstractmethod
from dataclasses import dataclass, field
from typing import Any, List, Optional
import copy

class Command(ABC):
    """Undoableæ“ä½œã®åŸºåº•ã‚¯ãƒ©ã‚¹"""

    @abstractmethod
    def execute(self) -> None:
        """æ“ä½œã‚’å®Ÿè¡Œ"""
        pass

    @abstractmethod
    def undo(self) -> None:
        """æ“ä½œã‚’å–ã‚Šæ¶ˆã—"""
        pass

    @property
    @abstractmethod
    def description(self) -> str:
        """æ“ä½œã®èª¬æ˜ï¼ˆUIè¡¨ç¤ºç”¨ï¼‰"""
        pass


@dataclass
class EditSubtitleCommand(Command):
    """å­—å¹•ç·¨é›†ã‚³ãƒãƒ³ãƒ‰"""
    subtitle_manager: Any  # SubtitleManager
    index: int
    old_text: str
    new_text: str
    field: str  # "original" or "translated"

    def execute(self) -> None:
        self.subtitle_manager.update_text(
            self.index, self.field, self.new_text
        )

    def undo(self) -> None:
        self.subtitle_manager.update_text(
            self.index, self.field, self.old_text
        )

    @property
    def description(self) -> str:
        return f"å­—å¹•#{self.index + 1}ã‚’ç·¨é›†"


@dataclass
class EditSubtitleTimingCommand(Command):
    """å­—å¹•ã‚¿ã‚¤ãƒŸãƒ³ã‚°ç·¨é›†ã‚³ãƒãƒ³ãƒ‰"""
    subtitle_manager: Any
    index: int
    old_start: float
    old_end: float
    new_start: float
    new_end: float

    def execute(self) -> None:
        self.subtitle_manager.update_timing(
            self.index, self.new_start, self.new_end
        )

    def undo(self) -> None:
        self.subtitle_manager.update_timing(
            self.index, self.old_start, self.old_end
        )

    @property
    def description(self) -> str:
        return f"å­—å¹•#{self.index + 1}ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ç·¨é›†"


@dataclass
class EditSegmentCommand(Command):
    """ã‚»ã‚°ãƒ¡ãƒ³ãƒˆç·¨é›†ã‚³ãƒãƒ³ãƒ‰"""
    segment_manager: Any
    segment_id: int
    old_state: dict
    new_state: dict

    def execute(self) -> None:
        self.segment_manager.update_segment(self.segment_id, self.new_state)

    def undo(self) -> None:
        self.segment_manager.update_segment(self.segment_id, self.old_state)

    @property
    def description(self) -> str:
        return f"ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã€Œ{self.old_state.get('title', '')}ã€ã‚’ç·¨é›†"


@dataclass
class ToggleSegmentCommand(Command):
    """ã‚»ã‚°ãƒ¡ãƒ³ãƒˆé¸æŠåˆ‡ã‚Šæ›¿ãˆã‚³ãƒãƒ³ãƒ‰"""
    segment_manager: Any
    segment_id: int
    old_selected: bool
    new_selected: bool

    def execute(self) -> None:
        self.segment_manager.set_selected(self.segment_id, self.new_selected)

    def undo(self) -> None:
        self.segment_manager.set_selected(self.segment_id, self.old_selected)

    @property
    def description(self) -> str:
        action = "é¸æŠ" if self.new_selected else "é¸æŠè§£é™¤"
        return f"ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’{action}"


@dataclass
class CompositeCommand(Command):
    """è¤‡æ•°ã‚³ãƒãƒ³ãƒ‰ã‚’ã¾ã¨ã‚ãŸã‚³ãƒãƒ³ãƒ‰"""
    commands: List[Command]
    _description: str = "è¤‡åˆæ“ä½œ"

    def execute(self) -> None:
        for cmd in self.commands:
            cmd.execute()

    def undo(self) -> None:
        # é€†é †ã§undo
        for cmd in reversed(self.commands):
            cmd.undo()

    @property
    def description(self) -> str:
        return self._description


class UndoManager:
    """Undo/Redoç®¡ç†"""

    def __init__(self, max_history: int = 100):
        self.max_history = max_history
        self._undo_stack: List[Command] = []
        self._redo_stack: List[Command] = []
        self._observers: List[callable] = []

    def execute(self, command: Command) -> None:
        """ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦Undoã‚¹ã‚¿ãƒƒã‚¯ã«è¿½åŠ """
        command.execute()
        self._undo_stack.append(command)

        # Redoå±¥æ­´ã‚’ã‚¯ãƒªã‚¢
        self._redo_stack.clear()

        # å±¥æ­´æ•°åˆ¶é™
        if len(self._undo_stack) > self.max_history:
            self._undo_stack.pop(0)

        self._notify_observers()

    def undo(self) -> Optional[str]:
        """æœ€å¾Œã®æ“ä½œã‚’å–ã‚Šæ¶ˆã—"""
        if not self.can_undo():
            return None

        command = self._undo_stack.pop()
        command.undo()
        self._redo_stack.append(command)

        self._notify_observers()
        return command.description

    def redo(self) -> Optional[str]:
        """å–ã‚Šæ¶ˆã—ãŸæ“ä½œã‚’ã‚„ã‚Šç›´ã—"""
        if not self.can_redo():
            return None

        command = self._redo_stack.pop()
        command.execute()
        self._undo_stack.append(command)

        self._notify_observers()
        return command.description

    def can_undo(self) -> bool:
        """Undoå¯èƒ½ã‹ã©ã†ã‹"""
        return len(self._undo_stack) > 0

    def can_redo(self) -> bool:
        """Redoå¯èƒ½ã‹ã©ã†ã‹"""
        return len(self._redo_stack) > 0

    def get_undo_description(self) -> Optional[str]:
        """æ¬¡ã®Undoæ“ä½œã®èª¬æ˜"""
        if self._undo_stack:
            return self._undo_stack[-1].description
        return None

    def get_redo_description(self) -> Optional[str]:
        """æ¬¡ã®Redoæ“ä½œã®èª¬æ˜"""
        if self._redo_stack:
            return self._redo_stack[-1].description
        return None

    def clear(self) -> None:
        """å±¥æ­´ã‚’ã‚¯ãƒªã‚¢"""
        self._undo_stack.clear()
        self._redo_stack.clear()
        self._notify_observers()

    def subscribe(self, callback: callable) -> None:
        """çŠ¶æ…‹å¤‰æ›´ã®é€šçŸ¥ã‚’è³¼èª­"""
        self._observers.append(callback)

    def _notify_observers(self) -> None:
        """ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ¼ã«é€šçŸ¥"""
        for callback in self._observers:
            callback(self.can_undo(), self.can_redo())


# ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆé€£æº
class EditorView(CTkFrame):
    def __init__(self, parent, undo_manager: UndoManager):
        super().__init__(parent)
        self.undo_manager = undo_manager

        # Undo/Redoãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’åŒæœŸ
        self.undo_manager.subscribe(self._update_undo_buttons)

    def _update_undo_buttons(self, can_undo: bool, can_redo: bool):
        """Undo/Redoãƒœã‚¿ãƒ³ã®æœ‰åŠ¹/ç„¡åŠ¹ã‚’æ›´æ–°"""
        self.undo_button.configure(state="normal" if can_undo else "disabled")
        self.redo_button.configure(state="normal" if can_redo else "disabled")

        # ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚‚æ›´æ–°
        if can_undo:
            undo_desc = self.undo_manager.get_undo_description()
            self.undo_button.configure(
                tooltip=f"å…ƒã«æˆ»ã™: {undo_desc} (Ctrl+Z)"
            )
```

### 13.5 ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—è©³ç´°

```python
from enum import Enum
from dataclasses import dataclass
from typing import Optional, Callable, Any
import tkinter as tk
import tkinter.dnd as tkdnd

class DragType(Enum):
    """ãƒ‰ãƒ©ãƒƒã‚°ã®ç¨®é¡"""
    SEGMENT = "segment"      # ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ä¸¦ã³æ›¿ãˆ
    TIMELINE = "timeline"    # ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ä¸Šã§ã®ç¯„å›²å¤‰æ›´
    FILE = "file"           # å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‰ãƒ­ãƒƒãƒ—

@dataclass
class DragData:
    """ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ãƒ‡ãƒ¼ã‚¿"""
    drag_type: DragType
    source_index: Optional[int] = None
    source_widget: Optional[tk.Widget] = None
    data: Any = None

class DragDropManager:
    """ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ç®¡ç†"""

    def __init__(self, root: tk.Tk):
        self.root = root
        self.drag_data: Optional[DragData] = None
        self.drop_targets: list = []

        # ãƒ‰ãƒ©ãƒƒã‚°ã‚«ãƒ¼ã‚½ãƒ«ç”¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦
        self.drag_label: Optional[tk.Toplevel] = None

    def start_drag(
        self,
        event: tk.Event,
        drag_type: DragType,
        data: Any,
        label_text: str = ""
    ) -> None:
        """ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹"""
        self.drag_data = DragData(
            drag_type=drag_type,
            source_widget=event.widget,
            data=data
        )

        # ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®è¦–è¦šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
        if label_text:
            self._create_drag_label(event, label_text)

        # ãƒã‚¦ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒã‚¤ãƒ³ãƒ‰
        self.root.bind("<Motion>", self._on_drag_motion)
        self.root.bind("<ButtonRelease-1>", self._on_drag_end)

    def _create_drag_label(self, event: tk.Event, text: str) -> None:
        """ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã«è¡¨ç¤ºã™ã‚‹ãƒ©ãƒ™ãƒ«"""
        self.drag_label = tk.Toplevel(self.root)
        self.drag_label.overrideredirect(True)  # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ ãªã—
        self.drag_label.attributes("-alpha", 0.8)  # åŠé€æ˜

        label = tk.Label(
            self.drag_label,
            text=text,
            bg="#3b82f6",
            fg="white",
            padx=10,
            pady=5
        )
        label.pack()

        self._update_drag_label_position(event)

    def _update_drag_label_position(self, event: tk.Event) -> None:
        """ãƒ‰ãƒ©ãƒƒã‚°ãƒ©ãƒ™ãƒ«ã®ä½ç½®ã‚’æ›´æ–°"""
        if self.drag_label:
            self.drag_label.geometry(f"+{event.x_root + 10}+{event.y_root + 10}")

    def _on_drag_motion(self, event: tk.Event) -> None:
        """ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ãƒã‚¦ã‚¹ç§»å‹•"""
        self._update_drag_label_position(event)

        # ãƒ‰ãƒ­ãƒƒãƒ—ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        for target in self.drop_targets:
            if self._is_over_widget(event, target["widget"]):
                target["widget"].configure(
                    highlightbackground="#3b82f6",
                    highlightthickness=2
                )
            else:
                target["widget"].configure(highlightthickness=0)

    def _on_drag_end(self, event: tk.Event) -> None:
        """ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†"""
        # ãƒ‰ãƒ©ãƒƒã‚°ãƒ©ãƒ™ãƒ«ã‚’å‰Šé™¤
        if self.drag_label:
            self.drag_label.destroy()
            self.drag_label = None

        # ãƒ‰ãƒ­ãƒƒãƒ—å‡¦ç†
        if self.drag_data:
            for target in self.drop_targets:
                if (self._is_over_widget(event, target["widget"]) and
                    target["accepts"](self.drag_data.drag_type)):
                    target["on_drop"](self.drag_data, event)
                    break

        # ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
        self.drag_data = None
        self.root.unbind("<Motion>")
        self.root.unbind("<ButtonRelease-1>")

        # ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
        for target in self.drop_targets:
            target["widget"].configure(highlightthickness=0)

    def _is_over_widget(self, event: tk.Event, widget: tk.Widget) -> bool:
        """ã‚«ãƒ¼ã‚½ãƒ«ãŒã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆä¸Šã«ã‚ã‚‹ã‹"""
        try:
            x = widget.winfo_rootx()
            y = widget.winfo_rooty()
            w = widget.winfo_width()
            h = widget.winfo_height()
            return x <= event.x_root < x + w and y <= event.y_root < y + h
        except tk.TclError:
            return False

    def register_drop_target(
        self,
        widget: tk.Widget,
        accepts: Callable[[DragType], bool],
        on_drop: Callable[[DragData, tk.Event], None]
    ) -> None:
        """ãƒ‰ãƒ­ãƒƒãƒ—ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’ç™»éŒ²"""
        self.drop_targets.append({
            "widget": widget,
            "accepts": accepts,
            "on_drop": on_drop
        })


# ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒªã‚¹ãƒˆã§ã®ä½¿ç”¨ä¾‹
class SegmentList(CTkScrollableFrame):
    def __init__(self, parent, drag_drop_manager: DragDropManager):
        super().__init__(parent)
        self.dd_manager = drag_drop_manager
        self.segments: List[dict] = []

        # ãƒ‰ãƒ­ãƒƒãƒ—ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ã—ã¦ç™»éŒ²
        self.dd_manager.register_drop_target(
            widget=self,
            accepts=lambda t: t == DragType.SEGMENT,
            on_drop=self._on_segment_drop
        )

    def _create_segment_item(self, index: int, segment: dict) -> CTkFrame:
        """ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã‚’ä½œæˆ"""
        frame = CTkFrame(self)

        # ãƒ‰ãƒ©ãƒƒã‚°ãƒãƒ³ãƒ‰ãƒ«
        handle = CTkLabel(frame, text="â ¿", cursor="fleur")
        handle.bind("<Button-1>", lambda e: self._start_segment_drag(e, index))

        return frame

    def _start_segment_drag(self, event: tk.Event, index: int) -> None:
        """ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ãƒ‰ãƒ©ãƒƒã‚°ã‚’é–‹å§‹"""
        segment = self.segments[index]
        self.dd_manager.start_drag(
            event=event,
            drag_type=DragType.SEGMENT,
            data={"index": index, "segment": segment},
            label_text=segment.get("title", f"ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ {index + 1}")
        )

    def _on_segment_drop(self, drag_data: DragData, event: tk.Event) -> None:
        """ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãŒãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚ŒãŸ"""
        source_index = drag_data.data["index"]
        target_index = self._get_drop_index(event)

        if source_index != target_index:
            # ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®é †åºã‚’å¤‰æ›´
            segment = self.segments.pop(source_index)
            self.segments.insert(target_index, segment)
            self._refresh_list()

            # Undoã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦è¨˜éŒ²
            self.on_reorder_callback(source_index, target_index)


# å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‰ãƒ­ãƒƒãƒ—ï¼ˆURLã‚„ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
class HomeView(CTkFrame):
    def __init__(self, parent):
        super().__init__(parent)

        # TkinterDnDã‚’ä½¿ç”¨ï¼ˆè¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼‰
        try:
            self.drop_target_register(tkdnd.DND_FILES)
            self.dnd_bind("<<Drop>>", self._on_file_drop)
        except Exception:
            # TkinterDnDãŒåˆ©ç”¨ã§ããªã„å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
            pass

    def _on_file_drop(self, event) -> None:
        """ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚ŒãŸ"""
        files = event.data.split()
        for file_path in files:
            # ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’å‡¦ç†
            if file_path.endswith((".mp4", ".mkv", ".webm")):
                self._load_local_video(file_path)
```

### 13.6 ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†

```python
from enum import Enum
from typing import Optional, List
import tkinter as tk

class FocusGroup(Enum):
    """ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—"""
    MAIN_MENU = "main_menu"
    VIDEO_PLAYER = "video_player"
    TIMELINE = "timeline"
    SEGMENT_LIST = "segment_list"
    SUBTITLE_TABLE = "subtitle_table"
    DIALOG = "dialog"

class FocusManager:
    """ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†"""

    def __init__(self, root: tk.Tk):
        self.root = root
        self.focus_groups: dict[FocusGroup, List[tk.Widget]] = {}
        self.current_group: Optional[FocusGroup] = None
        self.focus_history: List[tk.Widget] = []

        # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰
        self.root.bind("<Tab>", self._on_tab)
        self.root.bind("<Shift-Tab>", self._on_shift_tab)
        self.root.bind("<Escape>", self._on_escape)

    def register_widget(
        self,
        widget: tk.Widget,
        group: FocusGroup,
        tab_order: int = 0
    ) -> None:
        """ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã«ç™»éŒ²"""
        if group not in self.focus_groups:
            self.focus_groups[group] = []

        self.focus_groups[group].append({
            "widget": widget,
            "order": tab_order
        })

        # ã‚½ãƒ¼ãƒˆ
        self.focus_groups[group].sort(key=lambda x: x["order"])

        # ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¤ãƒ³/ã‚¢ã‚¦ãƒˆã‚¤ãƒ™ãƒ³ãƒˆ
        widget.bind("<FocusIn>", lambda e: self._on_focus_in(widget, group))
        widget.bind("<FocusOut>", lambda e: self._on_focus_out(widget))

    def _on_focus_in(self, widget: tk.Widget, group: FocusGroup) -> None:
        """ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å—ã‘å–ã£ãŸ"""
        self.current_group = group
        self.focus_history.append(widget)

        # è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
        self._highlight_focused(widget)

    def _on_focus_out(self, widget: tk.Widget) -> None:
        """ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å¤±ã£ãŸ"""
        self._remove_highlight(widget)

    def _highlight_focused(self, widget: tk.Widget) -> None:
        """ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ä¸­ã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ"""
        try:
            # CustomTkinterã®å ´åˆ
            if hasattr(widget, "configure"):
                widget.configure(border_color="#3b82f6")
        except Exception:
            pass

    def _remove_highlight(self, widget: tk.Widget) -> None:
        """ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’è§£é™¤"""
        try:
            if hasattr(widget, "configure"):
                widget.configure(border_color="gray50")
        except Exception:
            pass

    def _on_tab(self, event: tk.Event) -> str:
        """Tab ã‚­ãƒ¼ã§ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç§»å‹•"""
        if self.current_group and self.current_group in self.focus_groups:
            widgets = self.focus_groups[self.current_group]
            current = self.root.focus_get()

            # ç¾åœ¨ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¦‹ã¤ã‘ã‚‹
            current_idx = -1
            for i, item in enumerate(widgets):
                if item["widget"] == current:
                    current_idx = i
                    break

            # æ¬¡ã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
            next_idx = (current_idx + 1) % len(widgets)
            widgets[next_idx]["widget"].focus_set()

            return "break"  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ä½œã‚’æŠ‘åˆ¶

        return None

    def _on_shift_tab(self, event: tk.Event) -> str:
        """Shift+Tab ã§é€†æ–¹å‘ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç§»å‹•"""
        if self.current_group and self.current_group in self.focus_groups:
            widgets = self.focus_groups[self.current_group]
            current = self.root.focus_get()

            current_idx = -1
            for i, item in enumerate(widgets):
                if item["widget"] == current:
                    current_idx = i
                    break

            # å‰ã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
            prev_idx = (current_idx - 1) % len(widgets)
            widgets[prev_idx]["widget"].focus_set()

            return "break"

        return None

    def _on_escape(self, event: tk.Event) -> None:
        """Escape ã§ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è§£é™¤ã¾ãŸã¯å‰ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã«æˆ»ã‚‹"""
        if len(self.focus_history) > 1:
            # ç¾åœ¨ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å±¥æ­´ã‹ã‚‰å‰Šé™¤
            self.focus_history.pop()
            # å‰ã®ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
            prev_widget = self.focus_history[-1]
            if prev_widget.winfo_exists():
                prev_widget.focus_set()
        else:
            # ãƒ«ãƒ¼ãƒˆã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’æˆ»ã™
            self.root.focus_set()

    def set_focus_group(self, group: FocusGroup) -> None:
        """ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚°ãƒ«ãƒ¼ãƒ—ã‚’åˆ‡ã‚Šæ›¿ãˆ"""
        if group in self.focus_groups and self.focus_groups[group]:
            self.current_group = group
            self.focus_groups[group][0]["widget"].focus_set()

    def focus_dialog(self, dialog: tk.Toplevel) -> None:
        """ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’ç§»å‹•"""
        dialog.transient(self.root)
        dialog.grab_set()  # ãƒ¢ãƒ¼ãƒ€ãƒ«
        dialog.focus_set()

    def release_dialog(self) -> None:
        """ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‹ã‚‰ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’æˆ»ã™"""
        if self.focus_history:
            last_widget = self.focus_history[-1]
            if last_widget.winfo_exists():
                last_widget.focus_set()


# ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ
class AccessibleWidget:
    """ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œã®ãƒŸãƒƒã‚¯ã‚¹ã‚¤ãƒ³"""

    def set_accessible_name(self, name: str) -> None:
        """ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼ç”¨ã®åå‰ã‚’è¨­å®š"""
        # Tkinterã«ã¯ç›´æ¥çš„ãªARIAã‚µãƒãƒ¼ãƒˆã¯ãªã„ãŒã€
        # ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚„ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆã§ä»£ç”¨
        if hasattr(self, "configure"):
            try:
                self.configure(cursor="hand2")
            except Exception:
                pass

    def set_accessible_description(self, description: str) -> None:
        """ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼ç”¨ã®èª¬æ˜ã‚’è¨­å®š"""
        pass  # ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã§ä»£ç”¨
```

### 13.7 ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºUI

```python
from dataclasses import dataclass
from enum import Enum
from typing import Optional, List, Callable
import customtkinter as ctk
from datetime import datetime

class ErrorSeverity(Enum):
    """ã‚¨ãƒ©ãƒ¼ã®æ·±åˆ»åº¦"""
    INFO = "info"
    WARNING = "warning"
    ERROR = "error"
    CRITICAL = "critical"

@dataclass
class ErrorInfo:
    """ã‚¨ãƒ©ãƒ¼æƒ…å ±"""
    code: str               # YACT-XXXå½¢å¼
    message: str            # ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    severity: ErrorSeverity
    timestamp: datetime
    details: Optional[str] = None  # æŠ€è¡“çš„è©³ç´°
    action: Optional[str] = None   # æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
    retry_callback: Optional[Callable] = None  # ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ãªå ´åˆ

# è‰²è¨­å®š
ERROR_COLORS = {
    ErrorSeverity.INFO: {
        "bg": "#3b82f6",      # é’
        "icon": "â„¹ï¸"
    },
    ErrorSeverity.WARNING: {
        "bg": "#f59e0b",      # é»„
        "icon": "âš ï¸"
    },
    ErrorSeverity.ERROR: {
        "bg": "#ef4444",      # èµ¤
        "icon": "âŒ"
    },
    ErrorSeverity.CRITICAL: {
        "bg": "#7f1d1d",      # æ¿ƒã„èµ¤
        "icon": "ğŸš¨"
    },
}


class ToastNotification(ctk.CTkFrame):
    """ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ"""

    def __init__(
        self,
        parent,
        error: ErrorInfo,
        on_close: Callable = None,
        auto_dismiss: bool = True,
        dismiss_after_ms: int = 5000
    ):
        super().__init__(parent)
        self.error = error
        self.on_close = on_close

        colors = ERROR_COLORS[error.severity]
        self.configure(fg_color=colors["bg"], corner_radius=8)

        # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
        # ã‚¢ã‚¤ã‚³ãƒ³
        icon_label = ctk.CTkLabel(
            self,
            text=colors["icon"],
            font=("", 20)
        )
        icon_label.pack(side="left", padx=(10, 5))

        # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢
        msg_frame = ctk.CTkFrame(self, fg_color="transparent")
        msg_frame.pack(side="left", fill="both", expand=True, padx=5, pady=5)

        # ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ + ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        ctk.CTkLabel(
            msg_frame,
            text=f"[{error.code}] {error.message}",
            font=("", 12, "bold"),
            text_color="white",
            anchor="w"
        ).pack(fill="x")

        # æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
        if error.action:
            ctk.CTkLabel(
                msg_frame,
                text=error.action,
                font=("", 11),
                text_color="#e5e7eb",
                anchor="w"
            ).pack(fill="x")

        # ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢
        btn_frame = ctk.CTkFrame(self, fg_color="transparent")
        btn_frame.pack(side="right", padx=5)

        # ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³
        if error.retry_callback:
            retry_btn = ctk.CTkButton(
                btn_frame,
                text="ãƒªãƒˆãƒ©ã‚¤",
                width=60,
                height=24,
                command=lambda: self._on_retry()
            )
            retry_btn.pack(side="left", padx=2)

        # è©³ç´°ãƒœã‚¿ãƒ³
        if error.details:
            detail_btn = ctk.CTkButton(
                btn_frame,
                text="è©³ç´°",
                width=50,
                height=24,
                command=lambda: self._show_details()
            )
            detail_btn.pack(side="left", padx=2)

        # é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³
        close_btn = ctk.CTkButton(
            btn_frame,
            text="Ã—",
            width=24,
            height=24,
            command=self._close
        )
        close_btn.pack(side="left", padx=2)

        # è‡ªå‹•æ¶ˆå»
        if auto_dismiss and error.severity in [ErrorSeverity.INFO, ErrorSeverity.WARNING]:
            self.after(dismiss_after_ms, self._close)

    def _close(self):
        """é€šçŸ¥ã‚’é–‰ã˜ã‚‹"""
        if self.on_close:
            self.on_close()
        self.destroy()

    def _on_retry(self):
        """ãƒªãƒˆãƒ©ã‚¤å®Ÿè¡Œ"""
        if self.error.retry_callback:
            self._close()
            self.error.retry_callback()

    def _show_details(self):
        """è©³ç´°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º"""
        ErrorDetailDialog(self.winfo_toplevel(), self.error)


class ErrorDetailDialog(ctk.CTkToplevel):
    """ã‚¨ãƒ©ãƒ¼è©³ç´°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°"""

    def __init__(self, parent, error: ErrorInfo):
        super().__init__(parent)

        self.title(f"ã‚¨ãƒ©ãƒ¼è©³ç´° - {error.code}")
        self.geometry("500x400")
        self.transient(parent)
        self.grab_set()

        # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
        content = ctk.CTkScrollableFrame(self)
        content.pack(fill="both", expand=True, padx=20, pady=20)

        # ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰
        ctk.CTkLabel(
            content,
            text=f"ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰: {error.code}",
            font=("", 14, "bold")
        ).pack(anchor="w", pady=(0, 10))

        # æ·±åˆ»åº¦
        colors = ERROR_COLORS[error.severity]
        severity_label = ctk.CTkLabel(
            content,
            text=f"{colors['icon']} {error.severity.value.upper()}",
            fg_color=colors["bg"],
            corner_radius=4,
            padx=8,
            pady=2
        )
        severity_label.pack(anchor="w", pady=(0, 10))

        # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        ctk.CTkLabel(
            content,
            text="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:",
            font=("", 12, "bold")
        ).pack(anchor="w")
        ctk.CTkLabel(
            content,
            text=error.message,
            wraplength=450
        ).pack(anchor="w", pady=(0, 10))

        # è©³ç´°ï¼ˆæŠ€è¡“æƒ…å ±ï¼‰
        if error.details:
            ctk.CTkLabel(
                content,
                text="æŠ€è¡“çš„è©³ç´°:",
                font=("", 12, "bold")
            ).pack(anchor="w")

            detail_text = ctk.CTkTextbox(content, height=150)
            detail_text.pack(fill="x", pady=(0, 10))
            detail_text.insert("1.0", error.details)
            detail_text.configure(state="disabled")

        # æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
        if error.action:
            ctk.CTkLabel(
                content,
                text="æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:",
                font=("", 12, "bold")
            ).pack(anchor="w")
            ctk.CTkLabel(
                content,
                text=error.action,
                wraplength=450
            ).pack(anchor="w", pady=(0, 10))

        # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
        ctk.CTkLabel(
            content,
            text=f"ç™ºç”Ÿæ—¥æ™‚: {error.timestamp.strftime('%Y-%m-%d %H:%M:%S')}",
            text_color="gray"
        ).pack(anchor="w")

        # ãƒœã‚¿ãƒ³
        btn_frame = ctk.CTkFrame(self, fg_color="transparent")
        btn_frame.pack(fill="x", padx=20, pady=10)

        ctk.CTkButton(
            btn_frame,
            text="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼",
            command=lambda: self._copy_to_clipboard(error)
        ).pack(side="left")

        ctk.CTkButton(
            btn_frame,
            text="é–‰ã˜ã‚‹",
            command=self.destroy
        ).pack(side="right")

    def _copy_to_clipboard(self, error: ErrorInfo):
        """ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼"""
        text = f"""
ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰: {error.code}
æ·±åˆ»åº¦: {error.severity.value}
ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {error.message}
è©³ç´°: {error.details or 'ãªã—'}
ç™ºç”Ÿæ—¥æ™‚: {error.timestamp.isoformat()}
""".strip()

        self.clipboard_clear()
        self.clipboard_append(text)


class ErrorNotificationManager:
    """ã‚¨ãƒ©ãƒ¼é€šçŸ¥ç®¡ç†"""

    def __init__(self, parent: ctk.CTk):
        self.parent = parent
        self.notifications: List[ToastNotification] = []
        self.max_visible = 5

        # é€šçŸ¥ã‚¨ãƒªã‚¢ï¼ˆç”»é¢å³ä¸‹ï¼‰
        self.notification_container = ctk.CTkFrame(
            parent,
            fg_color="transparent"
        )
        self.notification_container.place(
            relx=1.0, rely=1.0,
            anchor="se",
            x=-20, y=-20
        )

    def show_error(self, error: ErrorInfo) -> None:
        """ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã‚’è¡¨ç¤º"""
        # æœ€å¤§æ•°ã‚’è¶…ãˆã¦ã„ã‚‹å ´åˆã¯å¤ã„ã‚‚ã®ã‚’å‰Šé™¤
        while len(self.notifications) >= self.max_visible:
            self.notifications[0].destroy()
            self.notifications.pop(0)

        toast = ToastNotification(
            self.notification_container,
            error,
            on_close=lambda: self._on_notification_close(toast)
        )
        toast.pack(pady=5, fill="x")
        self.notifications.append(toast)

    def _on_notification_close(self, toast: ToastNotification):
        """é€šçŸ¥ãŒé–‰ã˜ã‚‰ã‚ŒãŸ"""
        if toast in self.notifications:
            self.notifications.remove(toast)
```

### 13.8 åˆå›èµ·å‹•ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

```python
from dataclasses import dataclass
from typing import List, Optional, Callable
import customtkinter as ctk

@dataclass
class OnboardingStep:
    """ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ†ãƒƒãƒ—"""
    title: str
    description: str
    image_path: Optional[str] = None
    action: Optional[Callable] = None
    action_label: str = ""
    skip_if: Optional[Callable[[], bool]] = None  # æ¡ä»¶ä»˜ãã‚¹ã‚­ãƒƒãƒ—

class OnboardingWizard(ctk.CTkToplevel):
    """åˆå›èµ·å‹•ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰"""

    STEPS: List[OnboardingStep] = [
        OnboardingStep(
            title="ã‚ˆã†ã“ãï¼",
            description=(
                "YouTube Auto Clip Translator ã¸ã‚ˆã†ã“ãï¼\n\n"
                "ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€YouTubeå‹•ç”»ã‹ã‚‰è‡ªå‹•ã§è¦‹ã©ã“ã‚ã‚’æŠ½å‡ºã—ã€\n"
                "ç¿»è¨³å­—å¹•ä»˜ãã®ã‚·ãƒ§ãƒ¼ãƒˆå‹•ç”»ã‚’ä½œæˆã—ã¾ã™ã€‚"
            ),
        ),
        OnboardingStep(
            title="Gemini APIã‚­ãƒ¼ã®è¨­å®š",
            description=(
                "AIæ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯Google Gemini APIã‚­ãƒ¼ãŒå¿…è¦ã§ã™ã€‚\n\n"
                "1. Google AI Studio ã«ã‚¢ã‚¯ã‚»ã‚¹\n"
                "2. APIã‚­ãƒ¼ã‚’ä½œæˆ\n"
                "3. ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰è¨­å®š"
            ),
            action_label="APIã‚­ãƒ¼ã‚’è¨­å®š",
            skip_if=lambda: bool(get_config().get("gemini_api_key"))
        ),
        OnboardingStep(
            title="FFmpegã®ç¢ºèª",
            description=(
                "å‹•ç”»å‡¦ç†ã«ã¯FFmpegãŒå¿…è¦ã§ã™ã€‚\n\n"
                "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€\n"
                "è‡ªå‹•ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ã€‚"
            ),
        ),
        OnboardingStep(
            title="æº–å‚™å®Œäº†ï¼",
            description=(
                "ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸï¼\n\n"
                "YouTube URLã‚’å…¥åŠ›ã—ã¦ã€\n"
                "æœ€åˆã®å‹•ç”»ã‚’å‡¦ç†ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚"
            ),
        ),
    ]

    def __init__(self, parent, on_complete: Callable = None):
        super().__init__(parent)

        self.on_complete = on_complete
        self.current_step = 0
        self.filtered_steps = self._filter_steps()

        self.title("ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰")
        self.geometry("600x450")
        self.transient(parent)
        self.grab_set()

        # é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ï¼ˆã‚¹ã‚­ãƒƒãƒ—ã§å¯¾å¿œï¼‰
        self.protocol("WM_DELETE_WINDOW", self._on_skip)

        self._create_ui()
        self._show_step(0)

    def _filter_steps(self) -> List[OnboardingStep]:
        """ã‚¹ã‚­ãƒƒãƒ—æ¡ä»¶ã‚’æº€ãŸã™ã‚¹ãƒ†ãƒƒãƒ—ã‚’é™¤å¤–"""
        return [
            step for step in self.STEPS
            if not step.skip_if or not step.skip_if()
        ]

    def _create_ui(self):
        """UIä½œæˆ"""
        # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼
        self.progress_frame = ctk.CTkFrame(self, height=4)
        self.progress_frame.pack(fill="x", padx=20, pady=(20, 0))

        self.progress_segments: List[ctk.CTkFrame] = []
        for i in range(len(self.filtered_steps)):
            segment = ctk.CTkFrame(
                self.progress_frame,
                fg_color="gray70",
                height=4
            )
            segment.pack(side="left", fill="x", expand=True, padx=1)
            self.progress_segments.append(segment)

        # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢
        self.content_frame = ctk.CTkFrame(self, fg_color="transparent")
        self.content_frame.pack(fill="both", expand=True, padx=40, pady=20)

        # ã‚¿ã‚¤ãƒˆãƒ«
        self.title_label = ctk.CTkLabel(
            self.content_frame,
            text="",
            font=("", 24, "bold")
        )
        self.title_label.pack(pady=(20, 10))

        # èª¬æ˜
        self.description_label = ctk.CTkLabel(
            self.content_frame,
            text="",
            font=("", 14),
            justify="center"
        )
        self.description_label.pack(pady=10)

        # ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        self.action_button = ctk.CTkButton(
            self.content_frame,
            text="",
            command=self._on_action
        )

        # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³
        nav_frame = ctk.CTkFrame(self, fg_color="transparent")
        nav_frame.pack(fill="x", padx=40, pady=20)

        self.skip_button = ctk.CTkButton(
            nav_frame,
            text="ã‚¹ã‚­ãƒƒãƒ—",
            fg_color="transparent",
            text_color="gray",
            hover_color="gray20",
            command=self._on_skip
        )
        self.skip_button.pack(side="left")

        self.next_button = ctk.CTkButton(
            nav_frame,
            text="æ¬¡ã¸",
            command=self._on_next
        )
        self.next_button.pack(side="right")

        self.prev_button = ctk.CTkButton(
            nav_frame,
            text="æˆ»ã‚‹",
            fg_color="gray30",
            command=self._on_prev
        )
        self.prev_button.pack(side="right", padx=10)

    def _show_step(self, index: int):
        """ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¡¨ç¤º"""
        if index < 0 or index >= len(self.filtered_steps):
            return

        self.current_step = index
        step = self.filtered_steps[index]

        # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹æ›´æ–°
        for i, segment in enumerate(self.progress_segments):
            if i <= index:
                segment.configure(fg_color="#3b82f6")
            else:
                segment.configure(fg_color="gray70")

        # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ›´æ–°
        self.title_label.configure(text=step.title)
        self.description_label.configure(text=step.description)

        # ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³
        if step.action and step.action_label:
            self.action_button.configure(text=step.action_label)
            self.action_button.pack(pady=20)
        else:
            self.action_button.pack_forget()

        # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³çŠ¶æ…‹
        if index == 0:
            self.prev_button.configure(state="disabled")
        else:
            self.prev_button.configure(state="normal")

        if index == len(self.filtered_steps) - 1:
            self.next_button.configure(text="å®Œäº†")
        else:
            self.next_button.configure(text="æ¬¡ã¸")

    def _on_next(self):
        """æ¬¡ã¸ãƒœã‚¿ãƒ³"""
        if self.current_step < len(self.filtered_steps) - 1:
            self._show_step(self.current_step + 1)
        else:
            self._complete()

    def _on_prev(self):
        """æˆ»ã‚‹ãƒœã‚¿ãƒ³"""
        if self.current_step > 0:
            self._show_step(self.current_step - 1)

    def _on_action(self):
        """ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³"""
        step = self.filtered_steps[self.current_step]
        if step.action:
            step.action()

    def _on_skip(self):
        """ã‚¹ã‚­ãƒƒãƒ—"""
        self._complete()

    def _complete(self):
        """ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰å®Œäº†"""
        # åˆå›èµ·å‹•ãƒ•ãƒ©ã‚°ã‚’ä¿å­˜
        save_config({"onboarding_completed": True})

        if self.on_complete:
            self.on_complete()

        self.destroy()


# åˆå›èµ·å‹•ãƒã‚§ãƒƒã‚¯
def check_first_launch(app: ctk.CTk) -> bool:
    """åˆå›èµ·å‹•ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã€å¿…è¦ãªã‚‰ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã‚’è¡¨ç¤º"""
    config = load_config()

    if not config.get("onboarding_completed", False):
        # åˆå›èµ·å‹•
        OnboardingWizard(
            app,
            on_complete=lambda: app.navigate_to("home")
        )
        return True

    return False
```

### 13.9 é€²æ—ãƒãƒ¼ã®ç²’åº¦

```python
from dataclasses import dataclass
from enum import Enum
from typing import Optional, Callable, Dict
import customtkinter as ctk

class ProgressPhase(Enum):
    """å‡¦ç†ãƒ•ã‚§ãƒ¼ã‚º"""
    DOWNLOAD = "download"
    AUDIO_EXTRACT = "audio_extract"
    TRANSCRIPTION = "transcription"
    AI_ANALYSIS = "ai_analysis"
    VIDEO_EDIT = "video_edit"
    EXPORT = "export"

@dataclass
class PhaseConfig:
    """ãƒ•ã‚§ãƒ¼ã‚ºè¨­å®š"""
    name: str
    weight: float  # å…¨ä½“ã«å¯¾ã™ã‚‹é‡ã¿ï¼ˆåˆè¨ˆ1.0ï¼‰
    sub_steps: int  # ã‚µãƒ–ã‚¹ãƒ†ãƒƒãƒ—æ•°

# ãƒ•ã‚§ãƒ¼ã‚ºè¨­å®š
PHASE_CONFIGS: Dict[ProgressPhase, PhaseConfig] = {
    ProgressPhase.DOWNLOAD: PhaseConfig(
        name="å‹•ç”»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
        weight=0.15,
        sub_steps=100  # ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆå˜ä½
    ),
    ProgressPhase.AUDIO_EXTRACT: PhaseConfig(
        name="éŸ³å£°æŠ½å‡º",
        weight=0.05,
        sub_steps=1
    ),
    ProgressPhase.TRANSCRIPTION: PhaseConfig(
        name="æ–‡å­—èµ·ã“ã—",
        weight=0.30,
        sub_steps=100  # ãƒãƒ£ãƒ³ã‚¯æ•°ã«å¿œã˜ã¦
    ),
    ProgressPhase.AI_ANALYSIS: PhaseConfig(
        name="AIåˆ†æ",
        weight=0.20,
        sub_steps=5  # åˆ†æã‚¿ã‚¹ã‚¯æ•°
    ),
    ProgressPhase.VIDEO_EDIT: PhaseConfig(
        name="å‹•ç”»ç·¨é›†",
        weight=0.20,
        sub_steps=100
    ),
    ProgressPhase.EXPORT: PhaseConfig(
        name="æ›¸ãå‡ºã—",
        weight=0.10,
        sub_steps=100
    ),
}

class DetailedProgressTracker:
    """è©³ç´°ãªé€²æ—è¿½è·¡"""

    def __init__(self):
        self.current_phase: Optional[ProgressPhase] = None
        self.phase_progress: Dict[ProgressPhase, float] = {}
        self.observers: list = []

    def start_phase(self, phase: ProgressPhase) -> None:
        """ãƒ•ã‚§ãƒ¼ã‚ºé–‹å§‹"""
        self.current_phase = phase
        self.phase_progress[phase] = 0.0
        self._notify()

    def update_phase(self, progress: float) -> None:
        """ãƒ•ã‚§ãƒ¼ã‚ºé€²æ—æ›´æ–°ï¼ˆ0.0-1.0ï¼‰"""
        if self.current_phase:
            self.phase_progress[self.current_phase] = min(progress, 1.0)
            self._notify()

    def complete_phase(self) -> None:
        """ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†"""
        if self.current_phase:
            self.phase_progress[self.current_phase] = 1.0
            self._notify()

    def get_total_progress(self) -> float:
        """å…¨ä½“é€²æ—ã‚’è¨ˆç®—"""
        total = 0.0
        for phase, progress in self.phase_progress.items():
            config = PHASE_CONFIGS[phase]
            total += config.weight * progress
        return total

    def get_current_phase_name(self) -> str:
        """ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚ºå"""
        if self.current_phase:
            return PHASE_CONFIGS[self.current_phase].name
        return ""

    def subscribe(self, callback: Callable[[float, str], None]) -> None:
        """é€²æ—æ›´æ–°ã‚’è³¼èª­"""
        self.observers.append(callback)

    def _notify(self) -> None:
        """ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ¼ã«é€šçŸ¥"""
        total = self.get_total_progress()
        phase_name = self.get_current_phase_name()
        for callback in self.observers:
            callback(total, phase_name)


class EnhancedProgressBar(ctk.CTkFrame):
    """è©³ç´°ãªé€²æ—ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ"""

    def __init__(self, parent, tracker: DetailedProgressTracker):
        super().__init__(parent)
        self.tracker = tracker

        # ãƒ¡ã‚¤ãƒ³é€²æ—ãƒãƒ¼
        self.main_progress = ctk.CTkProgressBar(self, width=400)
        self.main_progress.pack(fill="x", padx=10, pady=(10, 5))
        self.main_progress.set(0)

        # ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆè¡¨ç¤º
        self.percent_label = ctk.CTkLabel(
            self,
            text="0%",
            font=("", 16, "bold")
        )
        self.percent_label.pack()

        # ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚ºè¡¨ç¤º
        self.phase_label = ctk.CTkLabel(
            self,
            text="æº–å‚™ä¸­...",
            font=("", 12),
            text_color="gray"
        )
        self.phase_label.pack()

        # ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥é€²æ—ï¼ˆå°ã•ã„ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼‰
        self.phase_indicators = ctk.CTkFrame(self, fg_color="transparent")
        self.phase_indicators.pack(fill="x", padx=10, pady=10)

        self._create_phase_indicators()

        # ãƒˆãƒ©ãƒƒã‚«ãƒ¼ã‚’è³¼èª­
        self.tracker.subscribe(self._on_progress_update)

    def _create_phase_indicators(self):
        """ãƒ•ã‚§ãƒ¼ã‚ºã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’ä½œæˆ"""
        self.indicators: Dict[ProgressPhase, ctk.CTkFrame] = {}

        for phase in ProgressPhase:
            config = PHASE_CONFIGS[phase]

            frame = ctk.CTkFrame(
                self.phase_indicators,
                fg_color="transparent"
            )
            frame.pack(side="left", expand=True, padx=2)

            # å°ã•ã„é€²æ—ãƒãƒ¼
            progress = ctk.CTkProgressBar(frame, width=50, height=4)
            progress.pack()
            progress.set(0)

            # ãƒ•ã‚§ãƒ¼ã‚ºå
            label = ctk.CTkLabel(
                frame,
                text=config.name[:4],  # çŸ­ç¸®è¡¨ç¤º
                font=("", 9),
                text_color="gray"
            )
            label.pack()

            self.indicators[phase] = {
                "frame": frame,
                "progress": progress,
                "label": label
            }

    def _on_progress_update(self, total: float, phase_name: str) -> None:
        """é€²æ—æ›´æ–°"""
        # ãƒ¡ã‚¤ãƒ³é€²æ—ãƒãƒ¼
        self.main_progress.set(total)
        self.percent_label.configure(text=f"{int(total * 100)}%")
        self.phase_label.configure(text=phase_name or "å‡¦ç†ä¸­...")

        # ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
        for phase, progress in self.tracker.phase_progress.items():
            indicator = self.indicators[phase]
            indicator["progress"].set(progress)

            # ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ•ã‚§ãƒ¼ã‚ºã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            if phase == self.tracker.current_phase:
                indicator["label"].configure(text_color="#3b82f6")
            elif progress >= 1.0:
                indicator["label"].configure(text_color="#22c55e")
            else:
                indicator["label"].configure(text_color="gray")


# ä½¿ç”¨ä¾‹
class ProcessingView(ctk.CTkFrame):
    def __init__(self, parent):
        super().__init__(parent)

        self.progress_tracker = DetailedProgressTracker()
        self.progress_bar = EnhancedProgressBar(self, self.progress_tracker)
        self.progress_bar.pack(pady=20)

    async def process_video(self, url: str):
        """å‹•ç”»å‡¦ç†ï¼ˆé€²æ—ä»˜ãï¼‰"""
        # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚§ãƒ¼ã‚º
        self.progress_tracker.start_phase(ProgressPhase.DOWNLOAD)
        async for progress in download_video(url):
            self.progress_tracker.update_phase(progress)
        self.progress_tracker.complete_phase()

        # éŸ³å£°æŠ½å‡ºãƒ•ã‚§ãƒ¼ã‚º
        self.progress_tracker.start_phase(ProgressPhase.AUDIO_EXTRACT)
        await extract_audio()
        self.progress_tracker.complete_phase()

        # æ–‡å­—èµ·ã“ã—ãƒ•ã‚§ãƒ¼ã‚º
        self.progress_tracker.start_phase(ProgressPhase.TRANSCRIPTION)
        async for progress in transcribe_audio():
            self.progress_tracker.update_phase(progress)
        self.progress_tracker.complete_phase()

        # ... ä»¥é™ã®ãƒ•ã‚§ãƒ¼ã‚ºã‚‚åŒæ§˜
```

### 13.10 å¤šè¨€èªUI

```python
from dataclasses import dataclass
from enum import Enum
from typing import Dict, Optional
import json
from pathlib import Path

class Language(Enum):
    """ã‚µãƒãƒ¼ãƒˆè¨€èª"""
    JA = "ja"  # æ—¥æœ¬èª
    EN = "en"  # English

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç¿»è¨³ï¼ˆæ—¥æœ¬èªï¼‰
DEFAULT_TRANSLATIONS: Dict[str, str] = {
    # å…±é€š
    "app.name": "YouTube Auto Clip Translator",
    "common.save": "ä¿å­˜",
    "common.cancel": "ã‚­ãƒ£ãƒ³ã‚»ãƒ«",
    "common.close": "é–‰ã˜ã‚‹",
    "common.next": "æ¬¡ã¸",
    "common.back": "æˆ»ã‚‹",
    "common.delete": "å‰Šé™¤",
    "common.edit": "ç·¨é›†",
    "common.ok": "OK",
    "common.yes": "ã¯ã„",
    "common.no": "ã„ã„ãˆ",
    "common.retry": "ãƒªãƒˆãƒ©ã‚¤",
    "common.loading": "èª­ã¿è¾¼ã¿ä¸­...",
    "common.processing": "å‡¦ç†ä¸­...",

    # ãƒ›ãƒ¼ãƒ ç”»é¢
    "home.title": "ãƒ›ãƒ¼ãƒ ",
    "home.url_placeholder": "YouTube URL ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",
    "home.start_button": "å‡¦ç†ã‚’é–‹å§‹",
    "home.recent_projects": "æœ€è¿‘ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ",
    "home.no_recent": "æœ€è¿‘ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“",

    # å‡¦ç†ç”»é¢
    "processing.title": "å‡¦ç†ä¸­...",
    "processing.downloading": "å‹•ç”»ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­...",
    "processing.extracting": "éŸ³å£°ã‚’æŠ½å‡ºä¸­...",
    "processing.transcribing": "æ–‡å­—èµ·ã“ã—ä¸­...",
    "processing.analyzing": "AIåˆ†æä¸­...",
    "processing.cancel_confirm": "å‡¦ç†ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã™ã‹ï¼Ÿ",

    # ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ç”»é¢
    "editor.title": "ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼",
    "editor.segments": "ã‚»ã‚°ãƒ¡ãƒ³ãƒˆä¸€è¦§",
    "editor.subtitles": "å­—å¹•ä¸€è¦§",
    "editor.add_segment": "ã‚»ã‚°ãƒ¡ãƒ³ãƒˆè¿½åŠ ",
    "editor.preview": "ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼",
    "editor.export": "æ›¸ãå‡ºã—",
    "editor.original": "åŸæ–‡",
    "editor.translated": "è¨³æ–‡",
    "editor.start_time": "é–‹å§‹",
    "editor.end_time": "çµ‚äº†",

    # è¨­å®šç”»é¢
    "settings.title": "è¨­å®š",
    "settings.general": "ä¸€èˆ¬è¨­å®š",
    "settings.theme": "ãƒ†ãƒ¼ãƒ",
    "settings.theme.dark": "ãƒ€ãƒ¼ã‚¯",
    "settings.theme.light": "ãƒ©ã‚¤ãƒˆ",
    "settings.language": "è¨€èª",
    "settings.api": "APIè¨­å®š",
    "settings.api_key": "APIã‚­ãƒ¼",
    "settings.api_valid": "æœ‰åŠ¹",
    "settings.api_invalid": "ç„¡åŠ¹",
    "settings.processing": "å‡¦ç†è¨­å®š",
    "settings.model": "WhisperXãƒ¢ãƒ‡ãƒ«",
    "settings.device": "ãƒ‡ãƒã‚¤ã‚¹",
    "settings.subtitle": "å­—å¹•è¨­å®š",
    "settings.font": "ãƒ•ã‚©ãƒ³ãƒˆ",
    "settings.font_size": "ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º",

    # ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    "error.network": "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",
    "error.api_key": "APIã‚­ãƒ¼ãŒç„¡åŠ¹ã§ã™",
    "error.download_failed": "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ",
    "error.processing_failed": "å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ",

    # ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
    "dialog.unsaved_changes": "ä¿å­˜ã—ã¦ã„ãªã„å¤‰æ›´ãŒã‚ã‚Šã¾ã™",
    "dialog.discard_changes": "å¤‰æ›´ã‚’ç ´æ£„ã—ã¾ã™ã‹ï¼Ÿ",
    "dialog.close_while_processing": "å‡¦ç†ä¸­ã§ã™ã€‚çµ‚äº†ã—ã¾ã™ã‹ï¼Ÿ",
}

# è‹±èªç¿»è¨³
EN_TRANSLATIONS: Dict[str, str] = {
    "app.name": "YouTube Auto Clip Translator",
    "common.save": "Save",
    "common.cancel": "Cancel",
    "common.close": "Close",
    "common.next": "Next",
    "common.back": "Back",
    "common.delete": "Delete",
    "common.edit": "Edit",
    "common.ok": "OK",
    "common.yes": "Yes",
    "common.no": "No",
    "common.retry": "Retry",
    "common.loading": "Loading...",
    "common.processing": "Processing...",

    "home.title": "Home",
    "home.url_placeholder": "Enter YouTube URL",
    "home.start_button": "Start Processing",
    "home.recent_projects": "Recent Projects",
    "home.no_recent": "No recent projects",

    "processing.title": "Processing...",
    "processing.downloading": "Downloading video...",
    "processing.extracting": "Extracting audio...",
    "processing.transcribing": "Transcribing...",
    "processing.analyzing": "AI analysis...",
    "processing.cancel_confirm": "Cancel processing?",

    "editor.title": "Editor",
    "editor.segments": "Segments",
    "editor.subtitles": "Subtitles",
    "editor.add_segment": "Add Segment",
    "editor.preview": "Preview",
    "editor.export": "Export",
    "editor.original": "Original",
    "editor.translated": "Translated",
    "editor.start_time": "Start",
    "editor.end_time": "End",

    "settings.title": "Settings",
    "settings.general": "General",
    "settings.theme": "Theme",
    "settings.theme.dark": "Dark",
    "settings.theme.light": "Light",
    "settings.language": "Language",
    "settings.api": "API Settings",
    "settings.api_key": "API Key",
    "settings.api_valid": "Valid",
    "settings.api_invalid": "Invalid",
    "settings.processing": "Processing",
    "settings.model": "WhisperX Model",
    "settings.device": "Device",
    "settings.subtitle": "Subtitle",
    "settings.font": "Font",
    "settings.font_size": "Font Size",

    "error.network": "Network error occurred",
    "error.api_key": "Invalid API key",
    "error.download_failed": "Download failed",
    "error.processing_failed": "Processing failed",

    "dialog.unsaved_changes": "You have unsaved changes",
    "dialog.discard_changes": "Discard changes?",
    "dialog.close_while_processing": "Processing in progress. Exit?",
}

# ç¿»è¨³è¾æ›¸
TRANSLATIONS: Dict[Language, Dict[str, str]] = {
    Language.JA: DEFAULT_TRANSLATIONS,
    Language.EN: EN_TRANSLATIONS,
}


class I18nManager:
    """å¤šè¨€èªå¯¾å¿œç®¡ç†"""

    _instance: Optional['I18nManager'] = None

    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
            cls._instance._initialized = False
        return cls._instance

    def __init__(self):
        if self._initialized:
            return

        self._current_language = Language.JA
        self._custom_translations: Dict[str, str] = {}
        self._observers: list = []
        self._initialized = True

    @property
    def current_language(self) -> Language:
        return self._current_language

    def set_language(self, language: Language) -> None:
        """è¨€èªã‚’å¤‰æ›´"""
        if language != self._current_language:
            self._current_language = language
            self._notify_observers()

    def t(self, key: str, **kwargs) -> str:
        """ç¿»è¨³ã‚’å–å¾—"""
        # ã‚«ã‚¹ã‚¿ãƒ ç¿»è¨³ã‚’å„ªå…ˆ
        if key in self._custom_translations:
            text = self._custom_translations[key]
        else:
            translations = TRANSLATIONS.get(
                self._current_language,
                DEFAULT_TRANSLATIONS
            )
            text = translations.get(key, key)

        # ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ç½®æ›
        for k, v in kwargs.items():
            text = text.replace(f"{{{k}}}", str(v))

        return text

    def load_custom_translations(self, path: Path) -> None:
        """ã‚«ã‚¹ã‚¿ãƒ ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿"""
        if path.exists():
            with open(path, 'r', encoding='utf-8') as f:
                self._custom_translations = json.load(f)

    def subscribe(self, callback: callable) -> None:
        """è¨€èªå¤‰æ›´é€šçŸ¥ã‚’è³¼èª­"""
        self._observers.append(callback)

    def unsubscribe(self, callback: callable) -> None:
        """è³¼èª­è§£é™¤"""
        if callback in self._observers:
            self._observers.remove(callback)

    def _notify_observers(self) -> None:
        """ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ¼ã«é€šçŸ¥"""
        for callback in self._observers:
            callback(self._current_language)


# ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
def t(key: str, **kwargs) -> str:
    """ç¿»è¨³ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ"""
    return I18nManager().t(key, **kwargs)

def set_language(language: Language) -> None:
    """è¨€èªè¨­å®šã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ"""
    I18nManager().set_language(language)


# ä½¿ç”¨ä¾‹
class LocalizedWidget(ctk.CTkFrame):
    """ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚ºå¯¾å¿œã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ"""

    def __init__(self, parent):
        super().__init__(parent)

        self.i18n = I18nManager()
        self.i18n.subscribe(self._on_language_change)

        self._create_widgets()

    def _create_widgets(self):
        """ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆä½œæˆ"""
        self.title_label = ctk.CTkLabel(
            self,
            text=t("home.title")
        )
        self.title_label.pack()

        self.start_button = ctk.CTkButton(
            self,
            text=t("home.start_button")
        )
        self.start_button.pack()

    def _on_language_change(self, language: Language):
        """è¨€èªå¤‰æ›´æ™‚ã®æ›´æ–°"""
        self.title_label.configure(text=t("home.title"))
        self.start_button.configure(text=t("home.start_button"))

    def destroy(self):
        """ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"""
        self.i18n.unsubscribe(self._on_language_change)
        super().destroy()
```

---

## 14. æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | å†…å®¹ |
|------|------|
| 2024-01-15 | åˆç‰ˆä½œæˆ |
| 2024-01-20 | è¿½åŠ ä»•æ§˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ ï¼ˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦åˆ¶ç´„ã€DPIå¯¾å¿œã€ãƒãƒ«ãƒãƒ¢ãƒ‹ã‚¿ã€Undo/Redoã€D&Dã€ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã€ã‚¨ãƒ©ãƒ¼UIã€ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€é€²æ—ãƒãƒ¼ã€å¤šè¨€èªUIï¼‰ |
